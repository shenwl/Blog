# Tree Shaking概念


1. babel-polify
- 设置了"useBuiltIns": "usage"，'@babel/polyfill'会自动引入
```json
{
   "presets": [
     ["@babel/preset-env", {
       "targets": {
         "chrome": "67",
         "ie": "9"
       },
       "useBuiltIns": "usage"
     }],
     "@babel/preset-react"
   ]
}
```

2. Tree Shaking只支持ES Module

- development mode 默认没有TreeShaking功能


3. 如何设置 Tree Shaking

- 在webpack配置加个optimization
  ```
  optimization: {
    usedExports: true,
  }
  ```

- 在package.json加一条sideEffects，不对"@babel/polly-fill"这类无导出的包做treeshaking
  ```
  "sideEffects": ["@babel/polly-fill"],
  ```

- 可以设置sideEffects为false，对所有模块做treeshaking，但是一般会设置忽略样式模块
 ```
  "sideEffects": ["*.css"],
 ```

3. 在development mode下设置了 TreeShaking，没有用到的方法还是存在，方便调试

- dist/main.js，中会有exports provided和exports used
```
/*! exports provided: add, minus */
/*! exports used: add */
// ...
```

4. mode: production TreeShaking生效
  - devtool去掉eval
  ```
  mode: 'production',
  devtool: 'cheap-module-source-map',
  ```

  - 也不需要设置optimization
